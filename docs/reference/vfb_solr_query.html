<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Query VFB via solr indexing system — vfb_solr_query • vfbr</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Query VFB via solr indexing system — vfb_solr_query" />

<meta property="og:description" content="Solr provides an extremely fast way to query all key content on
  VFB and is the backend used for most queries run on the website. It is
  pre-populated from the OWL ontology documents describing all the
  information on the site and their relationships. More details on Solr and
  its query syntax can be found at http://lucene.apache.org/solr/." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vfbr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jefferis/vfbr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Query VFB via solr indexing system</h1>
    <small class="dont-index">Source: <a href='https://github.com/jefferis/vfbr/blob/master/R/vfb_query.R'><code>R/vfb_query.R</code></a></small>
    <div class="hidden name"><code>vfb_solr_query.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Solr provides an extremely fast way to query all key content on
  VFB and is the backend used for most queries run on the website. It is
  pre-populated from the OWL ontology documents describing all the
  information on the site and their relationships. More details on Solr and
  its query syntax can be found at <a href='http://lucene.apache.org/solr/'>http://lucene.apache.org/solr/</a>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>vfb_solr_query</span>(<span class='kw'>query</span> <span class='kw'>=</span> <span class='st'>"*:*"</span>, <span class='kw'>filterquery</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fields</span> <span class='kw'>=</span> <span class='st'>"label+short_form"</span>, <span class='kw'>sort</span> <span class='kw'>=</span> <span class='st'>"score+desc"</span>,
  <span class='kw'>defaultfield</span> <span class='kw'>=</span> <span class='st'>"short_form"</span>, <span class='kw'>rows</span> <span class='kw'>=</span> <span class='fl'>30L</span>,
  <span class='kw'>path</span> <span class='kw'>=</span> <span class='st'>"solr/ontology/select?wt=json"</span>,
  <span class='kw'>server</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/options'>getOption</a></span>(<span class='st'>"vfbr.server.solr"</span>), <span class='kw'>parse.json</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>query</th>
      <td><p>A key-value list specifying the query</p></td>
    </tr>
    <tr>
      <th>filterquery</th>
      <td><p>A character vector (of length one or more) describing
filter queries for solr (see Details for regular vs filter queries)</p></td>
    </tr>
    <tr>
      <th>fields</th>
      <td><p>Which fields to return (+delimited). A value of <code>""</code>
implies all fields.</p></td>
    </tr>
    <tr>
      <th>sort</th>
      <td><p>Character vector naming one or more fields (+ delimited) to use
for sorting the results.</p></td>
    </tr>
    <tr>
      <th>defaultfield</th>
      <td><p>Character vector naming default field used for filter
queries (defaults to <code>short_form</code>)</p></td>
    </tr>
    <tr>
      <th>rows</th>
      <td><p>Maximum number of rows to return. The special value of Inf
implies all matching rows.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>The path on the server containing the query page</p></td>
    </tr>
    <tr>
      <th>server</th>
      <td><p>The base url of the server</p></td>
    </tr>
    <tr>
      <th>parse.json</th>
      <td><p>Whether or no to parse the response (default: TRUE)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional solr query arguments</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>When <code>parse.json=TRUE</code>, a data.frame containing the parsed
  response (originally the <code>response$docs</code> field in the parsed JSON)
  along with additional attributes including</p>
<p></p><ul>
<li><p>numFound</p></li>
<li><p>start</p></li>
<li><p>responseHeader</p></li>
</ul>

<p>When <code>parse.json=FALSE</code> an <code><a href='https://www.rdocumentation.org/packages/httr/topics/response'>httr::response</a></code> object</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>query</code> arguments maps onto the general solr <code>q=</code>
  query while <code>filterqueries</code> maps onto one or more <code>fl=</code> terms.
  The
  <a href='https://cwiki.apache.org/confluence/display/solr/Common+Query+Parameters'>solr
   wiki</a> says this about the difference:</p>
<p>The fq parameter defines a query that can be used to restrict the superset
  of documents that can be returned, without influencing score. It can be
  very useful for speeding up complex queries, since the queries specified
  with fq are cached independently of the main query. When a later query uses
  the same filter, there's a cache hit, and filter results are returned
  quickly from the cache.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/httr/topics/response'>response</a></code></p>
<p>Other query: <code><a href='vfb_neo4j_query.html'>vfb_neo4j_query</a></code>,
  <code><a href='vfb_owl_query.html'>vfb_owl_query</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Find VFB ids matching a given GMR line</span>
<span class='co'># note the field synonym_autosuggest will in future be the only one</span>
<span class='co'># matching GMR* ids</span>
<span class='fu'>vfb_solr_query</span>(<span class='kw'>filterquery</span><span class='kw'>=</span><span class='st'>"VFB_*"</span>,<span class='kw'>query</span><span class='kw'>=</span><span class='st'>"synonym_autosuggest:GMR_10A07*"</span>)</div><div class='output co'>#&gt;     short_form                    label
#&gt; 1 VFB_00023198 GMR_10A07_AE_01_09-fA01b</div><div class='input'>
<span class='co'># Find VFB ids matching a given VT Gal4 line</span>
<span class='fu'>vfb_solr_query</span>(<span class='kw'>filterquery</span><span class='kw'>=</span><span class='st'>"VFB_*"</span>,<span class='kw'>query</span><span class='kw'>=</span><span class='st'>"label:VT017929*"</span>)</div><div class='output co'>#&gt;     short_form                                        label
#&gt; 1 VFB_00064845   VT017929 GAL4 in the Adult VNC Dickson2017
#&gt; 2 VFB_00064844 VT017929 GAL4 in the Adult Brain Dickson2017</div><div class='input'>
<span class='co'># how many GMR lines can we find</span>
<span class='co'># note use of rows = 0 so we do not fetch results (but still get totals)</span>
<span class='no'>r</span><span class='kw'>=</span><span class='fu'>vfb_solr_query</span>(<span class='kw'>filterquery</span><span class='kw'>=</span><span class='st'>"VFB_*"</span>,<span class='kw'>query</span><span class='kw'>=</span><span class='st'>"label:GMR_*"</span>, <span class='kw'>rows</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/attr'>attr</a></span>(<span class='no'>r</span>,<span class='st'>'numFound'</span>)</div><div class='output co'>#&gt; [1] 3468</div><div class='input'><span class='co'>#' # VFB id for all GMR lines</span>
<span class='no'>all_gmr</span><span class='kw'>=</span><span class='fu'>vfb_solr_query</span>(<span class='kw'>filterquery</span><span class='kw'>=</span><span class='st'>"VFB_*"</span>,<span class='kw'>query</span><span class='kw'>=</span><span class='st'>"label:GMR_*"</span>, <span class='kw'>rows</span><span class='kw'>=</span><span class='fl'>4000</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='no'>all_gmr</span>)</div><div class='output co'>#&gt;     short_form                    label
#&gt; 1 VFB_00021308 GMR_16B10_AE_01_05-fA01b
#&gt; 2 VFB_00021309 GMR_85A07_AE_01_02-fA01b
#&gt; 3 VFB_00021306 GMR_12H02_AE_01_07-fA01b
#&gt; 4 VFB_00021307 GMR_42D11_AE_01_05-fA01b
#&gt; 5 VFB_00021311 GMR_41F05_AE_01_05-fA01b
#&gt; 6 VFB_00021312 GMR_36E07_AE_01_00-fA01b</div><div class='input'>
<span class='co'># VFB id for all FlyCircuit neurons</span>
<span class='co'># note use of rows=Inf to fetch all rows</span>
<span class='no'>all_fc</span><span class='kw'>=</span><span class='fu'>vfb_solr_query</span>(<span class='kw'>filterquery</span><span class='kw'>=</span><span class='st'>"VFB_*"</span>,
  <span class='kw'>query</span><span class='kw'>=</span><span class='st'>"source_data_link_annotation:*flycircuit*"</span>, <span class='kw'>rows</span><span class='kw'>=</span><span class='fl'>Inf</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='no'>all_fc</span>)</div><div class='output co'>#&gt; data frame with 0 columns and 0 rows</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

